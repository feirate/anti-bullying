{
  "enabled": true,
  "name": "安全扫描器",
  "description": "检查代码中是否包含API密钥或其他敏感信息，并提供安全建议",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "**/*"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "请扫描以下文件内容，检测可能的安全问题：\n\n1. 检查硬编码的敏感信息：\n   - API密钥（AWS、Google、OpenAI等）\n   - 密码和凭证\n   - 私钥\n   - 数据库连接字符串\n\n2. 如发现敏感信息：\n   - 高亮显示问题代码行\n   - 建议将敏感信息移至环境变量\n   - 提供.env文件的示例\n   - 检查.gitignore是否包含.env文件\n\n3. 检查私有URL：\n   - 内部API端点\n   - 开发环境URL\n   - 建议环境变量化处理\n\n4. 提交前检查：\n   - 分析是否有敏感信息将被提交\n   - 如有问题，发出警告并建议中止提交\n\n请提供详细分析结果和改进建议。"
  }
}